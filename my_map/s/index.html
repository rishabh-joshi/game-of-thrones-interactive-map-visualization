<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>
			My Map
		</title>
		<!-- Leaflet -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
		<link rel="stylesheet" href="lib/leaflet/leaflet.label.css" />
		<script src = "lib/leaflet/leaflet.label.js"></script>
		<script src = "lib/leaflet/leaflet.js"></script>

		<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
		<!-- Load Geojson -->
		<script src = 'data/countries.geojson'></script>
		<style type = 'text/css'>
			#map {height: 400px;}
			.legend {background: white; line-height: 1.5em}
			.legend i {width: 5em; float: left;}
			.myCSSClass {
				background: white;
				border: 2px solid black;}
			.leaflet-tooltip-left.myCSSClass::before {
				border-left-color: black;}
			.leaflet-tooltip-right.myCSSClass::before {border-right-color: black;}

		</style>
	</head>
	<body>
		<h1>My Map</h1>
		<div id='map'></div>
		<script>
			var countriesLayer;

			function highlightFeature(e){
				var layer = e.target;
				layer.setStyle(
				{
					weight:5,
					color:'black',
					fillColor:'white',
					fillOpacity:0.2
				}

					);
				if(!L.Browser.ie && !L.Browser.opera){
					layer.bringToFront();
				}
			} 

			function resetHighlight(e){
				countriesLayer.resetStyle(e.target);
			}
			function zoomToFeature(e){
				map.fitBounds(e.target.getBounds());
			}

			var markers = new Array();
			function countriesOnEachFeature(feature, layer){
				/*markers.push(
					L.circleMarker(
						layer.getBounds().getCenter(),
						{
							radius: 0.0,
							opacity: 0,
							fillOpacity: 0
						}
						)
					);
					var markersCount = markers.length;
					markers[markersCount-1].bindLabel(
						feature.properties.pop_est.toString(),
						{
							noHide: true,
							className: 'map-label',
							pane: 'mapPane'
						}
					);
					markers[markers-1].addTo(map);*/
				//layer.bindPopup(feature.properties.pop_est.toString());
				layer.bindTooltip(feature.properties.pop_est.toString(), {className: 'myCSSClass'});
				layer.on(
					{
						mouseover: highlightFeature,
						mouseout: resetHighlight,
						click: zoomToFeature
					}

					);
			}

			function getCountryColor(popEst){
				if(popEst>100000000){
					return 'red';
				}else if(popEst>50000000){
					return 'blue';
				}else{return 'green'}
			}
			function countriesStyle(feature){
				return {
					fillColor:getCountryColor(feature.properties.pop_est),
					weight:2,
					opacity:1,
					color:'white',
					dashArray:3,
					fillOpacity:0.7
				}
			}
			var map = L.map('map').setView([43.8476,18.3564],6);
			L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
			    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
			}).addTo(map);
			countriesLayer = L.geoJSON(
				countries,
				{
					style: countriesStyle,
					onEachFeature: countriesOnEachFeature
				}
				).addTo(map);
			 map.fitBounds(countriesLayer.getBounds());

			var legend = L.control({position:"bottomright"});
			legend.onAdd = function(map){
				var div = L.DomUtil.create('div','legend');
				var labels = ['Population greater than 10 million','Population greater than 5 million',"Population less of equal to 5 million"];
				var grades = [100000001,50000001,50000000];
				div.innerHTML = '<div><b>Legend</b></div>';
				for(var i = 0; i<grades.length; i++){
					div.innerHTML += '<i style = "background:'+getCountryColor(grades[i])+'">&nbsp;&nbsp;</i>&nbsp;&nbsp;'+labels[i]+'<br />';
				}
				return div;
			}
			legend.addTo(map);

			/*var point = [43.866667,18.416667];
			var marker = L.marker(point).addTo(map);

			var circle = L.circle(
				point,1000,{
					color:"purple",
					fillColor:"red",
					fillOpacity:0.8
				}).addTo(map);
			var greenIcon = L.icon(
				{
					iconUrl:"icon1.png",
					//shadowUrl:"http://leafletjs.com/docs/images/leaf-shadow.png",
					iconSize: [50, 95],
					//shadowSize: [50,64],
					iconAnchor: [22,94],
					//shadowAnchor: [4,62],
					popupAnchor: [-3,-76]

				})
			var marker = L.marker(point,{icon: greenIcon}).addTo(map);
				
			var myMarker = L.marker(point);
			myMarker.addTo(map);
			myMarker.bindPopup('<b>Hello world!</b><div><img style = "width:80%" src = "http://www.pngmart.com/files/4/London-Eye-PNG-Clipart.png" alt = "image"/></div>',
				{minWidth:200}

				);*/

			/*var imageUrl = 'data/map.png';
			var imageBounds = [
				[41.9137234789,-87.6672394823],
				[41.8327987897,-87.5829878978]
			];
			L.imageOverlay(imageUrl, imageBounds).addTo(map);
			map.fitBounds(imageBounds);*/

		</script>
	</body>
</html>
